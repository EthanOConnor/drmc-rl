diff --git a/envs/retro/placement_planner.py b/envs/retro/placement_planner.py
index 2c92b11..3f8dc1e 100644
--- a/envs/retro/placement_planner.py
+++ b/envs/retro/placement_planner.py
@@ -45,14 +45,41 @@ class PlacementPlanner:
-    def refresh(self) -> None:
-        """Resync internal model and (previously) precompute options."""
-        state, ram = self._read_state_and_ram()
-        self._snapshot = self._extract_pill(state, ram, require_mask=True)
-        self._plan_latency_ms = 0.0
-        self._plan_count = 0
-        # OLD: we used to compute masks/options here. That is now moved out.
+    def refresh(self, peek_only: bool = False) -> None:
+        """Resync internal model. If peek_only=True, do not run any planning."""
+        state, ram = self._read_state_and_ram()
+        require_mask = not peek_only
+        self._snapshot = self._extract_pill(state, ram, require_mask=require_mask)
+        self._plan_latency_ms = 0.0
+        self._plan_count = 0
+        if peek_only:
+            return
 
+    def plan_all_for_spawn(self) -> Optional[Dict[str, Any]]:
+        """Enumerate legal/feasible masks & option metadata once per spawn."""
+        if self._snapshot is None:
+            return None
+        t0 = time.perf_counter()
+        legal_mask, feasible_mask, options, costs, path_indices = self._plan_all()
+        self._plan_latency_ms = (time.perf_counter() - t0) * 1000.0
+        self._plan_count = 1
+        return {
+            "placements/legal_mask": legal_mask,
+            "placements/feasible_mask": feasible_mask,
+            "placements/options": options,
+            "placements/costs": costs,
+            "placements/path_indices": path_indices,
+        }
+
+    def get_plan_for_action(self, action_idx: int) -> Optional[PlanResult]:
+        """Return a micro-schedule only for the selected placement."""
+        if self._snapshot is None:
+            return None
+        return self._plan_single(action_idx)